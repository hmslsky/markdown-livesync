# 更新日志

## 1.0.2 (2024-12-19)

### 新增功能

- ✨ **主题切换系统增强**
  - 修复主题切换不生效的问题
  - 新增VSCode主题支持，能够跟随系统主题自动切换
  - 支持三种主题模式：VSCode主题、浅色主题、深色主题
  - 主题设置持久化保存，重启后保持用户选择
  - 添加系统主题变化监听，VSCode主题模式下自动响应系统明暗切换

- ✨ **代码块功能增强**
  - 新增代码块复制按钮，支持一键复制代码到剪贴板
  - 新增代码块行号显示，默认为所有代码块显示行号
  - 新增语言标签显示，在代码块左上角显示编程语言名称
  - 支持复制成功/失败的视觉反馈
  - 使用现代Clipboard API，提供降级方案确保兼容性
  - 优化代码块样式，支持水平滚动和响应式布局

### 用户体验改进

- 🎨 **视觉优化**
  - 代码块工具栏设计，包含语言标签和复制按钮
  - 行号与代码内容完美对齐
  - 支持深色和浅色主题的代码块样式
  - 添加悬停效果和过渡动画

- 🔧 **交互优化**
  - 复制按钮提供即时反馈（✅ 已复制 / ❌ 复制失败）
  - 主题切换按钮图标更新（🖥️ VSCode / 🌞 浅色 / 🌙 深色）
  - 改进按钮悬停和点击效果

### 技术改进

- 🔧 **代码架构**
  - 重构主题切换逻辑，正确处理三种主题模式
  - 新增代码块增强功能模块，支持动态解析和处理
  - 优化CSS样式组织，代码块样式独立管理
  - 改进JavaScript模块化，功能分离更清晰

- 🔧 **性能优化**
  - 代码块处理采用防重复标记，避免重复初始化
  - 内容更新时自动重新初始化代码块功能
  - 优化DOM操作，减少不必要的重绘

### 问题修复

- 🐛 **主题切换修复**
  - 修复VSCode主题模式下切换不生效的问题
  - 修复主题状态不同步的问题
  - 修复主题切换后样式不正确应用的问题

- 🐛 **样式修复**
  - 移除无效的TOC样式表引用
  - 修复代码块在不同主题下的显示问题
  - 优化滚动条样式，确保在所有主题下正确显示

### 测试和文档

- 📚 **新增测试文档**
  - 创建 `docs/examples/test-code-features.md` 代码块功能测试文档
  - 创建 `test-features.md` 简化测试文档
  - 包含多种编程语言的代码示例
  - 提供完整的功能测试清单

- 📚 **使用说明**
  - 主题切换：点击目录头部的主题切换按钮
  - 代码复制：点击代码块右上角的复制按钮
  - 行号显示：所有代码块默认显示行号
  - 语言标识：代码块左上角显示编程语言名称

## 1.0.0 (2024-06-09)

### 重大更新

- 🚀 **完全重构**: 将预览功能从浏览器迁移到 VSCode 内置预览面板
  - 提升性能和用户体验
  - 更好的集成度和稳定性
  - 支持更多 VSCode 原生功能

### 核心功能

- ✨ **预览面板增强**
  - 支持分屏显示和独立窗口
  - 支持多文件预览和标签页切换
  - 支持预览历史记录导航
  - 支持预览窗口状态保持

- ✨ **渲染系统优化**
  - 支持标准 Markdown 和 GitHub Flavored Markdown
  - 支持数学公式渲染（KaTeX）
  - 支持代码块语法高亮
  - 支持表格渲染和样式
  - 支持任务列表和复选框

- ✨ **目录导航改进**
  - 自动生成文档目录
  - 支持多级折叠/展开
  - 支持目录项高亮
  - 支持自定义目录样式

- ✨ **Mermaid 图表增强**
  - 支持所有主要图表类型
  - 支持图表交互和缩放
  - 支持图表主题切换
  - 支持图表导出功能
  - 支持全屏模式和编辑

### 性能优化

- ⚡ **渲染性能**
  - 实现分块渲染
  - 支持增量更新
  - 实现智能缓存
  - 支持资源懒加载

- ⚡ **内存优化**
  - 优化 Webview 生命周期管理
  - 实现智能缓存策略
  - 优化大文件处理

### 用户体验

- 🎨 **主题支持**
  - 自动适配 VSCode 主题
  - 支持自定义 CSS 样式
  - 支持自定义字体设置
  - 支持暗色/亮色主题切换

- 🔧 **配置系统**
  - 支持全局配置
  - 支持工作区配置
  - 支持文件级配置
  - 支持配置导入导出

### 安全性

- 🔒 **安全增强**
  - 实现内容安全策略（CSP）
  - 添加 XSS 防护机制
  - 优化资源访问权限
  - 实现安全的内容过滤

### 文档

- 📚 **文档更新**
  - 更新用户指南
  - 添加开发文档
  - 创建示例和教程
  - 完善 API 文档

## 1.0.1 (2024-06-09)

### 问题修复

- 🐛 **修复命令注册问题**
  - 修复 `markdown-livesync.openPreview` 命令无法找到的问题
  - 优化命令注册的错误处理和日志记录
  - 移除不必要的激活事件声明，适配 VSCode 1.75+ 版本

### 技术改进

- 🔧 优化命令执行时的错误处理
- 🔧 添加更详细的错误日志记录
- 🔧 改进用户错误提示信息

## 0.1.59 (2024-05-30)

### 测试文件整理

- 📚 重组测试文件结构，统一归入`tests/`目录
- 📚 创建`tests/README.md`说明文档
- 📚 按功能模块分类组织测试文件
- 📚 更新`.gitignore`和`.vscodeignore`配置

## 0.1.58 (2024-05-30)

### 文档整理

- 📚 整合所有Mermaid相关修复文档到`FIXES_SUMMARY.md`
- 📚 重组测试文件结构，将Mermaid测试文件移至`tests/mermaid/`目录
- 📚 更新`.gitignore`和`.vscodeignore`，优化文件管理

### 技术改进

- 🔧 优化文档结构，提高可维护性
- 🔧 改进测试文件组织，便于管理和维护

## 0.1.56 (2024-05-29)

### 新增功能

- ✨ **Mermaid图表支持**: 添加了完整的Mermaid图表渲染功能
  - 支持流程图、序列图、甘特图、类图、状态图、饼图等所有主要图表类型
  - 实时预览和同步更新
  - 错误处理和用户友好的错误显示
  - 响应式设计，适配不同屏幕尺寸

### 技术改进

- 🔧 新增 `mermaidPlugin.ts` 插件模块
- 🔧 集成 Mermaid.js v10.6.1 库
- 🔧 扩展前端渲染逻辑支持图表渲染
- 🔧 添加专用的Mermaid样式和错误处理样式

### 问题修复

- 🐛 **修复布局居中问题**: 改用flexbox布局替代text-align，确保markdown内容在有目录时正确居中
- 🐛 **修复Mermaid图表尺寸问题**:
  - 禁用Mermaid的useMaxWidth限制，让CSS完全控制尺寸
  - 实现真正的高度自适应，移除固定高度限制
  - 优化SVG响应式处理，确保在不同屏幕尺寸下正确显示

### 文档更新

- 📚 更新 README.md 添加Mermaid使用说明
- 📚 新增 MERMAID_SUPPORT.md 详细文档
- 📚 创建 test-mermaid.md 测试用例
- 📚 更新文档记录修复的问题和解决方案

## 0.1.50 (2024-05-11)

### 安全更新

- 添加SVG安全过滤功能，防止恶意SVG内容执行脚本
- 移除SVG标签中的危险属性，包括事件处理属性和远程资源链接
- 移除可能导致安全问题的HTML元素，如script、iframe等

### 改进

- 更新发布配置，优化插件包内容
- 添加.vscodeignore文件，排除不必要的文件

## 0.1.49 (2023-12-15)

### 功能

- 改进目录导航样式
- 优化Markdown预览性能
- 修复WebSocket连接问题

## 0.1.48 (2023-11-20)

### 功能

- 初始版本发布
- 支持实时Markdown预览
- 支持目录导航
- 光标位置同步
- 代码高亮